# Опис директорії `clusters/p72-flux`

Ця папка містить конфігурації для керування кластером Kubernetes через **Flux**, а також файли для розгортання різних застосунків та компонентів, включаючи моніторинговий стек. Нижче наведено опис структур директорій.

## Структура директорій:

### 1. **flux-system**
- **flux-system** — це директорія, що містить конфігураційні файли для налаштування **Flux** в кластері. Flux використовує ці YAML-файли для синхронізації стану кластера з Git-репозиторієм. Flux автоматично застосовує зміни до кластеру, забезпечуючи GitOps-підхід. Зміни в цій директорії регулярно перевіряються Flux і застосовуються до кластера.

### 2. **kbot-demo**
- **kbot-demo** — містить YAML-файли для розгортання застосунку **kbot** в кластері. Включає:
  - Опис неймспейсів.
  - **HelmRelease** файли для запуску застосунку через **Helm**.
  - Посилання на Git-репозиторій застосунку, з якого Flux витягує шаблони для деплойменту.

### 3. **monitoring**
- **monitoring** — директорія з YAML-файлами для автоматичного розгортання моніторингового стеку. Цей стек використовує кілька основних інструментів для збору метрик, логів і забезпечення стабільності роботи застосунків. Містить такі ключові компоненти:

#### Компоненти моніторингового стеку:
  
  1. **Cert-Manager**
     - Це інструмент для автоматичного управління SSL-сертифікатами в Kubernetes. Він інтегрується з різними сервісами сертифікації (наприклад, Let's Encrypt) і автоматично видає та продовжує сертифікати для сервісів у кластері.

  2. **FluentBit**
     - Легка та ефективна утиліта для збору, збагачення та доставки логів з Kubernetes. FluentBit збирає логи з контейнерів і перенаправляє їх до централізованих систем зберігання логів (наприклад, Loki або Elasticsearch).
  
  3. **Grafana**
     - Веб-інтерфейс для візуалізації даних та моніторингу на основі збору метрик. Інтегрується з Prometheus і Loki, забезпечуючи дашборди для відображення реального стану системи та запуску алертів.
  
  4. **Loki**
     - Система для збору, зберігання та пошуку логів з Kubernetes-кластерів. Loki зокрема добре інтегрується з Grafana для ефективного пошуку і аналізу логів.
  
  5. **OpenTelemetry**
     - Потужна платформа для збору та обробки трасування, метрик та логів. Забезпечує інструменти для створення **distributed tracing**, які допомагають зрозуміти поведінку розподілених застосунків.
  
  6. **Prometheus**
     - Система моніторингу та алертингу, яка збирає метрики з Kubernetes-кластера і його застосунків, зберігає їх і дозволяє системі Grafana відображати їх на дашбордах. Prometheus також забезпечує можливість автоматичної генерації алертів на основі метрик.

#### Файли в директорії:

- **kustomization.yaml** — файл для забезпечення конфігурації та керування ресурсами Kubernetes через механізми Kustomize.
- **ns-monitoring.yaml** — YAML-файл для створення простору імен (namespace) для всіх компонентів моніторингового стеку.

---

Ця структура дозволяє автоматизувати управління конфігурацією кластера і всіх необхідних застосунків за допомогою Flux та розгортати інструменти моніторингу для забезпечення стабільності та спостереження за станом застосунків.